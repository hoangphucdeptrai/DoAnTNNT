{% extends "base.html" %}
{% set page_type = "home" %}

{% block content %}
<!-- Hero Banner -->
<div class="row mb-4">
    <div class="col-12">
        <div class="p-5 text-center bg-light rounded-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <h1 class="display-4"><i class="fas fa-robot"></i> Chào mừng đến Shop Dê!</h1>
            <p class="lead">Mua sắm thông minh với công nghệ AI phân tích hành vi</p>
        </div>
    </div>
</div>

<!-- AI Stats -->
<div class="stats-box">
    <div class="row text-center">
        <div class="col-md-4">
            <h3 id="total-visits">0</h3>
            <small>Lượt truy cập</small>
        </div>
        <div class="col-md-4">
            <h3 id="avg-time">0s</h3>
            <small>Thời gian xem TB</small>
        </div>
        <div class="col-md-4">
            <h3 id="total-time">0s</h3>
            <small>Tổng thời gian</small>
        </div>
    </div>
</div>

<!-- Categories -->
<h3 class="mb-3"><i class="fas fa-th-large"></i> Danh Mục Sản Phẩm</h3>
<div class="row mb-4">
    {% for category in categories %}
    <div class="col-md-3 col-6 mb-3">
        <a href="/products?category={{ category }}" class="text-decoration-none">
            <div class="card category-badge text-center p-3">
                {% if category == 'Tất Cả' %}
                    <i class="fas fa-th fa-3x mb-2 text-primary"></i>
                {% elif category == 'Quần Áo' %}
                    <i class="fas fa-tshirt fa-3x mb-2 text-success"></i>
                {% elif category == 'Giày Dép' %}
                    <i class="fas fa-shoe-prints fa-3x mb-2 text-warning"></i>
                {% elif category == 'Phụ Kiện' %}
                    <i class="fas fa-gem fa-3x mb-2 text-danger"></i>
                {% else %}
                    <i class="fas fa-tag fa-3x mb-2 text-primary"></i>
                {% endif %}
                <h5>{{ category }}</h5>
            </div>
        </a>
    </div>
    {% endfor %}
</div>

<!-- Featured Products -->
<h3 class="mb-3"><i class="fas fa-fire"></i> Sản Phẩm Nổi Bật</h3>
<div class="row">
    {% for product in products[:6] %}
    <div class="col-md-4 col-sm-6 mb-4">
        <div class="card product-card h-100">
            <img src="{{ product.image }}" class="card-img-top" alt="{{ product.name }}" style="height: 250px; object-fit: cover;">
            <div class="card-body">
                <span class="badge bg-secondary mb-2">{{ product.category }}</span>
                <h5 class="card-title">{{ product.name }}</h5>
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="price">{{ "{:,.0f}".format(product.price) }}đ</span>
                    <small class="text-muted">
                        <i class="fas fa-star text-warning"></i> {{ product.rating }}
                    </small>
                </div>
                <small class="text-muted">Đã bán {{ product.sold }}</small>
                <div class="mt-3">
                    <a href="/product/{{ product.id }}" class="btn btn-primary w-100">
                        <i class="fas fa-eye"></i> Xem Chi Tiết
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Load stats
    fetch('/api/stats')
        .then(res => res.json())
        .then(data => {
            document.getElementById('total-visits').innerText = data.total_visits;
            document.getElementById('avg-time').innerText = data.avg_time + 's';
            document.getElementById('total-time').innerText = data.total_time + 's';
        });
</script>
{% endblock %}
